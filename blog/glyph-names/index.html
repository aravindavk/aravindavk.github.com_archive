<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="google-site-verification" content="PwqxyVtbmKeb1wsrF8XJ5GQIPxlDxUupYnTEWPI3KLk" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="pragma" content="no-cache" />
    <link href="/theme/img/fav.png" rel="icon" type="image/x-icon" />
    <meta property="og:site_name" content="Aravinda VK"/>
    <link rel="apple-touch-icon" href="/theme/img/fav.png" />
    <title>Improving Kannada Fonts - Glyph Names</title>
    <meta property="og:title" content="Improving Kannada Fonts - Glyph Names" data-dynamic="true"/>
    <meta property="twitter:title" content="Improving Kannada Fonts - Glyph Names" data-dynamic="true" />
    <meta name="description" content="For most use cases glyph names doesn't matter, it is font developers choice to give different names to the glyphs and write font rules according to their glyph names" data-dynamic="true" />
    <meta property="og:description" content="For most use cases glyph names doesn't matter, it is font developers choice to give different names to the glyphs and write font rules according to their glyph names" data-dynamic="true" />
    <meta property="twitter:description" content="For most use cases glyph names doesn't matter, it is font developers choice to give different names to the glyphs and write font rules according to their glyph names" data-dynamic="true" />
    <meta property="og:url" content="http://aravindavk.in/blog/glyph-names/" data-dynamic="true" />
    <meta property="twitter:url" content="http://aravindavk.in/blog/glyph-names/" data-dynamic="true" />
    <meta property="og:image" content="http://aravindavk.in" data-dynamic="true" />
    <link href="http://aravindavk.in/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Aravinda VK Atom Feed" />
    <link rel="stylesheet" href="/theme/css/pure-min.css" />
    <link rel="stylesheet" href="/theme/css/side-menu.css" />
    <link rel="stylesheet" href="/theme/css/main.css" />
    <link rel="stylesheet" href="/theme/css/pygment-emacs-highlight.css" />
  </head>
  <body>
    <div id="layout">
      <!-- Menu toggle -->
      <a href="#menu" id="menuLink" class="menu-link">
        <!-- Hamburger icon -->
        <span></span>
      </a>
      <div id="menu" class="pure-hidden-desktop pure-hidden-tablet">
        <div class="pure-menu pure-menu-open">
          <a class="pure-menu-heading logo" href="/"><img src="/theme/img/logo.png" alt="aravindavk"/></a>
          <div class="social-icons">
            <a href="http://aravindavk.in/feeds/all.atom.xml" target="_blank" title="News">
              <img src="/theme/img/feed.png" class="link-icon" alt="News"/>
            </a>
            <a href="http://twitter.com/aravindavk" target="_blank" title="Twitter">
              <img src="/theme/img/twitter.png" class="link-icon" alt="Twitter"/>
            </a>
            <a href="https://plus.google.com/+aravindavk" target="_blank" title="Google Plus">
              <img src="/theme/img/gplus.png" class="link-icon" alt="Google Plus"/>
            </a>
            <a href="https://github.com/aravindavk" target="_blank" title="Github">
              <img src="/theme/img/github.png" class="link-icon" alt="Github"/>
            </a>
            <a href="http://www.flickr.com/photos/aravindavk" target="_blank" title="Flickr">
              <img src="/theme/img/flickr.png" class="link-icon" alt="Flickr"/>
            </a>
            <a href="http://in.linkedin.com/in/aravindavk" target="_blank" title="LinkedIn">
              <img src="/theme/img/linkedin.png" class="link-icon" alt="LinkedIn"/>
            </a>
          </div>
          <ul>
            <li class=""><a href="/">Home</a></li>
            <li class=""><a href="/me">About</a></li>
            <li class=""><a href="/projects">Projects</a></li>
            <li class=""><a href="/blogs">Blogs</a></li>
            <li class=""><a href="/talks">Talks & Articles</a></li>
          </ul>
        </div>
        <div class="sep"></div>
        <div class="copyright">&copy; 2008-2014 Aravinda VK, <br/>All rights reserved</div>
      </div>

      <div class="pure-g-r">
        <div class="pure-u-4-5 content-left">
          <div class="left article">
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        Improving Kannada Fonts - Glyph Names</h1>
    </header>
    <div class="pure-hidden-phone pure-hidden-tablet">
<footer class="post-info">
  <p class="author-and-date-info">
    Posted on Tue 24 December 2013 by <a class="url fn" href="http://aravindavk.in">Aravinda VK</a>.
  </p>
</footer><!-- /.post-info -->
<div class="sep"></div>    </div>
    <div class="entry-content">
      <p>During <a class="reference external" href="http://www.mediawiki.org/wiki/Language_portal/Pune_LanguageSummit_November_2013">#languageSummitPune</a>, <a class="reference external" href="http://pravin-s.blogspot.in/">Pravin</a> explained about glyph naming specification by adobe and its benifits.</p>
<p>Glyph is a entity inside font which holds the co-ordinates information about a shape(letter). For most use cases glyph names doesn't matter, it is font developers choice to give different names to the glyphs and write font rules according to their glyph names. Rendering engine always deals with Unicode values and font returns respective glyphs to display based on the rules and glyphs inside font.</p>
<div class="section" id="so-what-is-the-problem">
<h2>So what is the problem?</h2>
<p>PDF. pdf displays unicode chars even though no rendering support present in the system(thats why it is called portable documents :P), how it is possible? At the time of pdf generation instead of storing unicode values it stores the glyph sequence of the text and embed's the font. While viewing it arranges the glyphs as per the sequence and displays it, no need to worry about font/rendering rules.</p>
<p>When user types some phrase to find inside pdf, pdf readers will try to convert unicode value of input phrase into glyph sequence and looks inside pdf for that sequence. If each font uses its own glyph names it not possible to reverse lookup by pdf reader and text search fails.</p>
<p><a class="reference external" href="http://sourceforge.net/adobe/aglfn/wiki/AGL%20Specification/">Adobe Glyph specification</a> suggests to name the glyph as unicode value with <code>uni</code> prefix. For example Unicode value of Kannada letter <code>ಅ</code> is <cite>U+0C85</cite>, so we have to name the glyph <code>ಅ</code> as <cite>uni0C85</cite>.</p>
<p>Some font developers prefer to name the glyphs as some human readable name instead of code name(like <cite>avowelknd</cite>, <code>kaknd</code> etc). Human readable names may help at the time of adding rules, but their are other problems associated with it. If we use our own naming in the font then we should take care adding those names in <a class="reference external" href="http://sourceforge.net/adobe/aglfn/wiki/Home/">glyphlist.txt</a>. We will endup introducing one more naming standard for each language, also untill all pdf reader software picks up the updated glyphlist, new names will not be used in pdf search. Another important problem is that all fonts developer will not agree to use the glyph naming proposed by one font developer. (For example one can propose language name as prefix and other can say language name as suffix, <code>kaknd</code> or <code>kndka</code> or <cite>knka</cite>)</p>
</div>
<div class="section" id="glyph-name-ligature">
<h2>Glyph name - Ligature</h2>
<p>If a glyph shape is formed by two or more unicode values and the resultant glyph doesn't have any unicode value then the glyph should be named as combination of two glyph names seperated by underscore. Suffix can be added to differenciate between multiple ligatures for the same unicode value combination. In the below example, suffix <code>.abvs</code> is used since this ligature will be used in opentype feature <cite>abvs</cite> (above base substitution).</p>
<img alt="ki" src="/images/fontrules/group2.png" />
<p>An example to understand how this reverse lookup works. Kannada text <cite>ಮಂಕುತಿಮ್ಮ</cite>, Unicode splitup and glyph names for the same is</p>
<img alt="ಮಂಕುತಿಮ್ಮ - Unicode" src="/images/mankutimma-unicode.png" />
<p>Glyph names stored inside pdf are as follows(ignores all the suffix and joins together using underscore)</p>
<div class="highlight"><pre>0CAE_0C82_0C95_0CC1_0CA4_0CBF_0CAE_0CCD_0CAE
</pre></div>
<p>Following psudo code shows how to convert unicode string to glyphs list without any help of rendering engine.</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">get_glyphs_list</span><span class="p">(</span><span class="n">unicode_str</span><span class="p">):</span>
    <span class="n">glyph_seq</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">letter</span> <span class="ow">in</span> <span class="n">unicode_str</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">letter</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;0x&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="n">glyph_seq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="s">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">glyph_seq</span><span class="p">)</span>

<span class="c"># Example:</span>
<span class="k">print</span> <span class="n">get_glyphs_list</span><span class="p">(</span><span class="s">u&quot;ಮಂಕುತಿಮ್ಮ&quot;</span><span class="p">)</span>
<span class="c"># Output:</span>
<span class="c"># 0CAE_0C82_0C95_0CC1_0CA4_0CBF_0CAE_0CCD_0CAE</span>
</pre></div>
<p>When we fetch glyph list for text <code>ಕಿ</code> above function returns <cite>0C95_0CBF</cite>, which is easy to search from the available glyph list.</p>
</div>
<div class="section" id="problems">
<h2>Problems:</h2>
<p>In case of vattakshara, for example <cite>ತಿಮ್ಮಿ</cite>, dependent vowel will be reordered as shown in the image below, so resultant glyphset will be <code>0CA4_0CBF_0CAE_0CBF_0CCD_0CAE</code> but above function returns as <cite>0CA4_0CBF_0CAE_0CCD_0CAE_0CBF</cite>.</p>
</div>
<div class="section" id="glyph-names-validator">
<h2>Glyph names validator:</h2>
<p>I created a tool using python to validate the glyph names, which accepts two parameters a font file and a text file with possible letters/words. It uses <code>hb-shape</code> to get the glyphs list from the input text file, and generates required glyphs list and compares between them.</p>
<p>Download the python script from <a class="reference external" href="https://raw.github.com/aravindavk/fontscripts/master/validate_glyphnames.py">here</a></p>
<div class="highlight"><pre>python validate_glyphnames.py Gubbi.ttf kannada_tests.txt
</pre></div>
<p>Sample test file</p>
<div class="highlight"><pre>ಅ
ಆ
ಇ
ಈ
ಕಾ
</pre></div>
<p>Will write more about this tool later, If glyph names are standardized then we can create lot of automation tools.</p>
<p>Let us start using the glyph names as <code>uniXXXX</code> format, I am not sure about the solution for above mentioned problem, let me know your suggestion.</p>
<p>C &amp; S welcome.</p>
</div>

    </div><!-- /.entry-content -->
    <div class="pure-hidden-desktop">
<footer class="post-info">
  <p class="author-and-date-info">
    Posted on Tue 24 December 2013 by <a class="url fn" href="http://aravindavk.in">Aravinda VK</a>.
  </p>
</footer><!-- /.post-info -->
<div class="sep"></div>    </div>
    <div class="permalink-div">
      Permalink: <a href="http://aravindavk.in/blog/glyph-names/" rel="bookmark" title="Permalink to Improving Kannada Fonts - Glyph Names">http://aravindavk.in/blog/glyph-names/</a>
    </div>
<div class="comments">
  <h2>Comments !</h2>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_identifier = "blog/glyph-names/";
    var disqus_url = "http://aravindavk.in/blog/glyph-names/";
    (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = 'http://vkaravinda.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
</div>
  </article>
</section>
            <div class="copyright pure-hidden-desktop pure-hidden-tablet">&copy; 2008-2014 Aravinda VK, <br/>All rights reserved</div>
          </div>
        </div>
        <div class="pure-u-1-5 pure-hidden-phone">
          <div class="right">
            <img class="me" src="/theme/img/me.jpg"/>
            <div class="sep"></div>
            <div class="pure-menu pure-menu-open">
              <a class="pure-menu-heading logo" href="/"><img src="/theme/img/logo.png" alt="aravindavk"/></a>
              <div class="social-icons">
                <a href="http://aravindavk.in/feeds/all.atom.xml" target="_blank" title="News">
                  <img src="/theme/img/feed.png" class="link-icon" alt="News"/>
                </a>
                <a href="http://twitter.com/aravindavk" target="_blank" title="Twitter">
                  <img src="/theme/img/twitter.png" class="link-icon" alt="Twitter"/>
                </a>
                <a href="https://plus.google.com/+aravindavk" target="_blank" title="Google Plus">
                  <img src="/theme/img/gplus.png" class="link-icon" alt="Google Plus"/>
                </a>
                <a href="https://github.com/aravindavk" target="_blank" title="Github">
                  <img src="/theme/img/github.png" class="link-icon" alt="Github"/>
                </a>
                <a href="http://www.flickr.com/photos/aravindavk" target="_blank" title="Flickr">
                  <img src="/theme/img/flickr.png" class="link-icon" alt="Flickr"/>
                </a>
                <a href="http://in.linkedin.com/in/aravindavk" target="_blank" title="LinkedIn">
                  <img src="/theme/img/linkedin.png" class="link-icon" alt="LinkedIn"/>
                </a>
              </div>
              <ul>
                <li class=""><a href="/">Home</a></li>
                <li class=""><a href="/me">About</a></li>
                <li class=""><a href="/projects">Projects</a></li>
                <li class=""><a href="/blogs">Blogs</a></li>
                <li class=""><a href="/talks">Talks & Articles</a></li>
              </ul>
            </div>
            <div class="sep"></div>
            <div class="copyright">&copy; 2008-2014 Aravinda VK, <br/>All rights reserved</div>
          </div>
        </div>
      </div>

    </div>
    <script src="/theme/js/ui.js"></script>
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-11830111-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </body>
</html>